<%@page language="abap" %>                                                                                                                                                                                                                                     
<!DOCTYPE html>                                                                                                                                                                                                                                                
<html>                                                                                                                                                                                                                                                         
  <head>                                                                                                                                                                                                                                                       
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />                                                                                                                                                                                 
    <title>Avionics Example Page</title>                                                                                                                                                                                                                       
    <link type="text/css" href="css/redmond/jquery-ui-1.8.6.custom.css" rel="stylesheet" />                                                                                                                                                                    
    <link type="text/css" href="avionics.css" rel="stylesheet" />                                                                                                                                                                                              
    <script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>                                                                                                                                                                                      
    <script type="text/javascript" src="js/jquery-ui-1.8.6.custom.min.js"></script>                                                                                                                                                                            
    <script type="text/javascript" src="avionics.js"></script>                                                                                                                                                                                                 
    <script>                                                                                                                                                                                                                                                   
    var snapshot = null;                                                                                                                                                                                                                                       
    var command = null;                                                                                                                                                                                                                                        
    var connected = true;                                                                                                                                                                                                                                      
    $(function(){                                                                                                                                                                                                                                              
      set_compass(0);                                                                                                                                                                                                                                          
      set_altimeter(0);                                                                                                                                                                                                                                        
      set_pitch_angle(0);                                                                                                                                                                                                                                      
      set_roll_angle(0);                                                                                                                                                                                                                                       
      set_airspeed(0);                                                                                                                                                                                                                                         
      set_vertspeed(0);                                                                                                                                                                                                                                        
      update_navdata();                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      $('img[command*=]').click(function(){                                                                                                                                                                                                                    
      command = $(this).attr('command');                                                                                                                                                                                                                       
      console.log("Command="+command);                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
      $.getJSON('command.json?command='+command, function(data){                                                                                                                                                                                               
          if(command=="snapshot")                                                                                                                                                                                                                              
          {                                                                                                                                                                                                                                                    
            console.log("Snapshot="+data.navdata.snapshot);                                                                                                                                                                                                    
            snapshot = 'http://192.168.178.37/~graham/Robbo/DemoJam/avionics/snapshots/'+                                                                                                                                                                      
              data.navdata.snapshot;                                                                                                                                                                                                                           
            $('<div id="snapshot" title="AR.Drone Snapshot">'+                                                                                                                                                                                                 
              '<img style="-webkit-user-select: none" '+                                                                                                                                                                                                       
              'src="super-mono/sticker/icons/camera.png"></div>'+                                                                                                                                                                                              
              '</div>').dialog({ width: 370 });                                                                                                                                                                                                                
              $(this).delay(1000);                                                                                                                                                                                                                             
              $('.ui-dialog-content img:last').attr('src',snapshot)                                                                                                                                                                                            
            $('#ui-dialog-title-snapshot').click(function(){                                                                                                                                                                                                   
              $('.ui-dialog-content img:last').attr('src','super-mono/sticker/icons/camera.png')                                                                                                                                                               
              $('.ui-dialog-content img:last').attr('src',snapshot)                                                                                                                                                                                            
            });                                                                                                                                                                                                                                                
          }                                                                                                                                                                                                                                                    
        });                                                                                                                                                                                                                                                    
      });                                                                                                                                                                                                                                                      
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
    function update_navdata()                                                                                                                                                                                                                                  
    {                                                                                                                                                                                                                                                          
      if(!connected) return;                                                                                                                                                                                                                                   
      console.log("Calling UPDATE_NAVDATA");                                                                                                                                                                                                                   
      $.getJSON('command.json?command=REFRESH', function(data){                                                                                                                                                                                                
        set_compass(data.navdata.psi);                                                                                                                                                                                                                         
        set_altimeter(data.navdata.altitude);                                                                                                                                                                                                                  
        set_pitch_angle(data.navdata.theta);                                                                                                                                                                                                                   
        set_roll_angle(data.navdata.phi);                                                                                                                                                                                                                      
        //$(this).delay(10);                                                                                                                                                                                                                                   
        update_navdata();                                                                                                                                                                                                                                      
      });                                                                                                                                                                                                                                                      
    }                                                                                                                                                                                                                                                          
    </script>                                                                                                                                                                                                                                                  
  </head>                                                                                                                                                                                                                                                      
  <body>                                                                                                                                                                                                                                                       
  <h1>Avionics Demo</h1>                                                                                                                                                                                                                                       
    <div>                                                                                                                                                                                                                                                      
      <div id="altimeter">                                                                                                                                                                                                                                     
        <div id="altnum1"><img src="images/Bandeau_Derouleur.bmp"></div>                                                                                                                                                                                       
        <div id="altnum2"><img src="images/Bandeau_Derouleur.bmp"></div>                                                                                                                                                                                       
        <div id="altnum3"><img src="images/Bandeau_Derouleur.bmp"></div>                                                                                                                                                                                       
        <div id="altnum4"><img src="images/Bandeau_Derouleur.bmp"></div>                                                                                                                                                                                       
        <div id="altnum5"><img src="images/Bandeau_Derouleur.bmp"></div>                                                                                                                                                                                       
        <div id="altimeterbackground"><img src="images/Altimeter_Background.gif"></div>                                                                                                                                                                        
        <div id="altimeterbigneedle"><img src="images/LongNeedleAltimeter.gif"></div>                                                                                                                                                                          
        <div id="altimeterlittleneedle"><img src="images/SmallNeedleAltimeter.gif"></div>                                                                                                                                                                      
      </div>                                                                                                                                                                                                                                                   
      <div id="compass">                                                                                                                                                                                                                                       
        <div id="compassbackground"><img src="images/HeadingIndicator_Background.gif"></div>                                                                                                                                                                   
        <div id="compasswheel"><img src="images/HeadingWeel.gif"></div>                                                                                                                                                                                        
        <div id="compassneedle"><img src="images/HeadingIndicator_Aircraft.gif"></div>                                                                                                                                                                         
      </div>                                                                                                                                                                                                                                                   
      <div id="horizon">                                                                                                                                                                                                                                       
        <div id="horizonbackground"><img src="images/Horizon_Background.gif"></div>                                                                                                                                                                            
        <div id="horizongroundsky"><img src="images/Horizon_GroundSky.bmp"></div>                                                                                                                                                                              
        <div id="horizonavion"><img src="images/Maquette_Avion.gif"></div>                                                                                                                                                                                     
      </div>                                                                                                                                                                                                                                                   
      <div id="airspeed">                                                                                                                                                                                                                                      
        <div id="airspeedbackground"><img src="images/AirSpeedIndicator_Background.gif"></div>                                                                                                                                                                 
        <div id="airspeedneedle"><img src="images/AirSpeedNeedle.gif"></div>                                                                                                                                                                                   
      </div>                                                                                                                                                                                                                                                   
      <div id="turncoord">                                                                                                                                                                                                                                     
        <div id="turncoordbackground"><img src="images/TurnCoordinator_Background.gif"></div>                                                                                                                                                                  
        <div id="turncoordmarks"><img src="images/TurnCoordinatorMarks.gif"></div>                                                                                                                                                                             
        <div id="turncoordaircraft"><img src="images/TurnCoordinatorAircraft.gif"></div>                                                                                                                                                                       
        <div id="turncoordball"><img src="images/TurnCoordinatorBall.gif"></div>                                                                                                                                                                               
      </div>                                                                                                                                                                                                                                                   
      <div id="vertspeed">                                                                                                                                                                                                                                     
        <div id="vertspeedbackground"><img src="images/verticalSpeedIndicator_Background.gif"></div>                                                                                                                                                           
        <div id="vertspeedneedle"><img src="images/verticalSpeedNeedle.gif"></div>                                                                                                                                                                             
      </div>                                                                                                                                                                                                                                                   
    </div>                                                                                                                                                                                                                                                     
    <div class="filler1"></div>                                                                                                                                                                                                                                
    <div class="filler2"></div>                                                                                                                                                                                                                                
    <div class="filler3"></div>                                                                                                                                                                                                                                
    <div class="filler4"></div>                                                                                                                                                                                                                                
    <div id="controls" class="ui-widget ui-corner-all">                                                                                                                                                                                                        
        <table>                                                                                                                                                                                                                                                
          <tr>                                                                                                                                                                                                                                                 
            <td colspan=3 align="center">Attitude</td>                                                                                                                                                                                                         
            <td width="200px" rowspan="3">                                                                                                                                                                                                                     
              <img src="images/libermail-tux-pilot-12237.png">                                                                                                                                                                                                 
            </td>                                                                                                                                                                                                                                              
            <td colspan=3 align="center">Orientation</td>                                                                                                                                                                                                      
          </tr>                                                                                                                                                                                                                                                
          <tr>                                                                                                                                                                                                                                                 
            <td>                                                                                                                                                                                                                                               
              <img id="go_left" src="super-mono/sticker/icons/navigation-left.png">                                                                                                                                                                            
            </td>                                                                                                                                                                                                                                              
            <td>                                                                                                                                                                                                                                               
              <img id="go_up" command="up" src="super-mono/sticker/icons/navigation-up.png"><br />                                                                                                                                                             
              <img id="hover" command="hover" src="super-mono/sticker/icons/button-remove.png"><br />                                                                                                                                                          
              <img id="go_down" command="down" src="super-mono/sticker/icons/navigation-down.png">                                                                                                                                                             
            </td>                                                                                                                                                                                                                                              
            <td>                                                                                                                                                                                                                                               
              <img id="go_right" src="super-mono/sticker/icons/navigation-right.png">                                                                                                                                                                          
            </td>                                                                                                                                                                                                                                              
            <td>                                                                                                                                                                                                                                               
              <img id="go_left" command="spin_left" src="super-mono/sticker/icons/navigation-left-frame.png">                                                                                                                                                  
            </td>                                                                                                                                                                                                                                              
            <td>                                                                                                                                                                                                                                               
              <img id="go_up" src="super-mono/sticker/icons/navigation-up-frame.png"><br />                                                                                                                                                                    
              <img id="hover" command="hover" src="super-mono/sticker/icons/web.png"><br />                                                                                                                                                                    
              <img id="go_down" src="super-mono/sticker/icons/navigation-down-frame.png">                                                                                                                                                                      
            </td>                                                                                                                                                                                                                                              
            <td>                                                                                                                                                                                                                                               
              <img id="go_right" command="spin_right" src="super-mono/sticker/icons/navigation-right-frame.png">                                                                                                                                               
            </td>                                                                                                                                                                                                                                              
          </tr>                                                                                                                                                                                                                                                
          <tr>                                                                                                                                                                                                                                                 
            <td align="center">                                                                                                                                                                                                                                
              <img id="green" command="launch" src="icons/32x32/traffic_lights_green.png">                                                                                                                                                                     
            </td>                                                                                                                                                                                                                                              
            <td align="center">                                                                                                                                                                                                                                
              <img id="yellow" command="hover" src="icons/32x32/traffic_lights_yellow.png">                                                                                                                                                                    
            </td>                                                                                                                                                                                                                                              
            <td align="center">                                                                                                                                                                                                                                
              <img id="red" command="land" src="icons/32x32/traffic_lights_red.png">                                                                                                                                                                           
            </td>                                                                                                                                                                                                                                              
            <td align="center">                                                                                                                                                                                                                                
              <img id="green" command="snapshot" src="super-mono/sticker/icons/camera.png">                                                                                                                                                                    
            </td>                                                                                                                                                                                                                                              
            <td align="center">                                                                                                                                                                                                                                
              <img id="green" command="pointsouth" src="super-mono/sticker/icons/compass.png">                                                                                                                                                                 
            </td>                                                                                                                                                                                                                                              
            <td align="center">                                                                                                                                                                                                                                
              <img id="green" command="shuffle" src="super-mono/sticker/icons/button-shuffle.png">                                                                                                                                                             
            </td>                                                                                                                                                                                                                                              
          </tr>                                                                                                                                                                                                                                                
        </table>                                                                                                                                                                                                                                               
      </div>                                                                                                                                                                                                                                                   
    </div>                                                                                                                                                                                                                                                     
  </body>                                                                                                                                                                                                                                                      
</html>                                                                                                                                                                                                                                                        